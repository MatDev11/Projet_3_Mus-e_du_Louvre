<?php
/**
 * Created by PhpStorm.
 * User: DarkRadish
 * Date: 23/02/2017
 * Time: 14:31
 */

namespace Ticketing\TicketingBundle\Service;


class PaiementStipe
{
    /**
     * @param $commande
     * @param $token
     * @return Response
     */

    public function paiementStipe($commande,$token)
    {

        \Stripe\Stripe::setApiKey("sk_test_8SR7kvJBumqoTbohzb613P1f");

        // Create a charge: this will charge the user's card
        try {
            \Stripe\Charge::create(array(
                "amount" => $commande->getPrix(),
                "currency" => "eur",
                "source" => $token,
                "description" => $commande->getName(),
            ));
            $statut = "ok";
        } catch(\Stripe\Error\Card $e) {
            // The card has been declined
            $statut = "pb";
        }

        return $statut;
    }

}